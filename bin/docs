#!/usr/bin/env ruby

require "optparse"
require "pathname"
require "fileutils"

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: docs [options]"

  opts.on("-h", "--help", "Display this help message") do
    puts opts
    exit
  end
end.parse!

public_dir = (Pathname(__FILE__).dirname / ".." / "docs" / "public" ).expand_path.to_s
docs_dir   =  public_dir + "/api"
brutjs_dir = (Pathname(__FILE__).dirname / ".." / "brut-js" ).expand_path.to_s

system(
  "bundle exec yard doc -o '#{docs_dir}' -m markdown -M rdiscount --backtrace"
)

FileUtils.chdir brutjs_dir do
  system("bin/build")
end
