<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Brut::Instrumentation::OpenTelemetry
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Brut::Instrumentation::OpenTelemetry";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (O)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Instrumentation.html" title="Brut::Instrumentation (module)">Instrumentation</a></span></span>
     &raquo; 
    <span class="title">OpenTelemetry</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Brut::Instrumentation::OpenTelemetry
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Brut::Instrumentation::OpenTelemetry</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/brut/instrumentation/open_telemetry.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Class to interact with the OpenTelemetry standard in a simpler way than
the provided Ruby gem does.  In general, you should use this class
via <code>Brut.container.instrumentation</code>, and you should <em>not</em> use the
OpenTelemetry ruby library directly.  You probably wouldn't want to, anyway.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span>, <span class='object_link'><a href="OpenTelemetry/Span.html" title="Brut::Instrumentation::OpenTelemetry::Span (class)">Span</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_attributes-instance_method" title="#add_attributes (instance method)">#<strong>add_attributes</strong>(attributes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds attributes to the span, converting the hash or keyword arguments to strings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_event-instance_method" title="#add_event (instance method)">#<strong>add_event</strong>(name, **attributes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds an event to the current span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_prefixed_attributes-instance_method" title="#add_prefixed_attributes (instance method)">#<strong>add_prefixed_attributes</strong>(prefix, attributes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Adds attributes to the span, prefixing each key with the given prefix, then converting the hash or keyword arguments to strings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#record_and_reraise_exception!-instance_method" title="#record_and_reraise_exception! (instance method)">#<strong>record_and_reraise_exception!</strong>(ex, attributes = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Record an exception and re-raise it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#record_exception-instance_method" title="#record_exception (instance method)">#<strong>record_exception</strong>(ex, attributes = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Record an exception.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#span-instance_method" title="#span (instance method)">#<strong>span</strong>(name, **attributes) {|Brut::Instrumentation::OpenTelemetry::Span| ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a span around the given block of code.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_attributes-instance_method">
  
    #<strong>add_attributes</strong>(attributes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds attributes to the span, converting the hash or keyword arguments to strings. This will use
the app's Otel prefix for all attributes, so you do not have to prefix them.
If you need to set standard attributes, you should use <span class='object_link'><a href="#add_prefixed_attributes-instance_method" title="Brut::Instrumentation::OpenTelemetry#add_prefixed_attributes (method)">#add_prefixed_attributes</a></span> instead.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>any attributes to attach to the event.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_attributes'>add_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_span'>current_span</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Brut::Instrumentation::OpenTelemetry (class)">OpenTelemetry</a></span></span><span class='op'>::</span><span class='const'>Trace</span><span class='period'>.</span><span class='id identifier rubyid_current_span'>current_span</span>
  <span class='id identifier rubyid_current_span'>current_span</span><span class='period'>.</span><span class='id identifier rubyid_add_attributes'>add_attributes</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#initialize-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='symbol'>:detect</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_h'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#to_h-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#to_h (method)">to_h</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_event-instance_method">
  
    #<strong>add_event</strong>(name, **attributes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds an event to the current span</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the name of the event. Should not contain dynamic information.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>any attributes to attach to the event.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_event'>add_event</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='op'>**</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_explicit_attributes'>explicit_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:attributes</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_timestamp'>timestamp</span> <span class='op'>=</span> <span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:timestamp</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_span'>current_span</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Brut::Instrumentation::OpenTelemetry (class)">OpenTelemetry</a></span></span><span class='op'>::</span><span class='const'>Trace</span><span class='period'>.</span><span class='id identifier rubyid_current_span'>current_span</span>
  <span class='id identifier rubyid_current_span'>current_span</span><span class='period'>.</span><span class='id identifier rubyid_add_event'>add_event</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
                         <span class='label'>attributes:</span> <span class='const'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#initialize-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_explicit_attributes'>explicit_attributes</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_h'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#to_h-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#to_h (method)">to_h</a></span></span><span class='comma'>,</span>
                         <span class='label'>timestamp:</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_prefixed_attributes-instance_method">
  
    #<strong>add_prefixed_attributes</strong>(prefix, attributes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Adds attributes to the span, prefixing each key with the given prefix, then converting the hash or keyword arguments to strings.  For example, if the prefix is 'my_app' and you add the attributes 'type' and 'reason', the actual attribute names will be 'my_app.type' and 'my_app.reason'.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#add_attributes-instance_method" title="Brut::Instrumentation::OpenTelemetry#add_attributes (method)">#add_attributes</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_prefixed_attributes'>add_prefixed_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_prefix'>prefix</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_span'>current_span</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Brut::Instrumentation::OpenTelemetry (class)">OpenTelemetry</a></span></span><span class='op'>::</span><span class='const'>Trace</span><span class='period'>.</span><span class='id identifier rubyid_current_span'>current_span</span>
  <span class='id identifier rubyid_current_span'>current_span</span><span class='period'>.</span><span class='id identifier rubyid_add_attributes'>add_attributes</span><span class='lparen'>(</span>
    <span class='const'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#initialize-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_prefix'>prefix</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_h'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#to_h-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#to_h (method)">to_h</a></span></span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="record_and_reraise_exception!-instance_method">
  
    #<strong>record_and_reraise_exception!</strong>(ex, attributes = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Record an exception and re-raise it. This is useful if you want
the exception recorded as part of the parent span, but still plan
to let it raise.  Don't do this for every exception you intend to raise.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ex</span>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the exception to record.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>any attributes to attach that will show up in your OTel provider</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the exception passed in.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_record_and_reraise_exception!'>record_and_reraise_exception!</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reecord_exception'>reecord_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_ex'>ex</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="record_exception-instance_method">
  
    #<strong>record_exception</strong>(ex, attributes = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Record an exception.  In general, use this only if:</p>

<ul>
<li>You need to have the parent span record this particular exception</li>
<li>You are not going to re-raise the exception.</li>
</ul>


<p>Otherwise, look at <span class='object_link'><a href="#record_and_reraise_exception!-instance_method" title="Brut::Instrumentation::OpenTelemetry#record_and_reraise_exception! (method)">#record_and_reraise_exception!</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ex</span>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the exception to record.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>any attributes to attach that will show up in your OTel provider</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_record_exception'>record_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_current_span'>current_span</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Brut::Instrumentation::OpenTelemetry (class)">OpenTelemetry</a></span></span><span class='op'>::</span><span class='const'>Trace</span><span class='period'>.</span><span class='id identifier rubyid_current_span'>current_span</span>
  <span class='id identifier rubyid_current_span'>current_span</span><span class='period'>.</span><span class='id identifier rubyid_record_exception'>record_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='comma'>,</span><span class='label'>attributes:</span> <span class='const'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#initialize-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_h'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#to_h-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#to_h (method)">to_h</a></span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="span-instance_method">
  
    #<strong>span</strong>(name, **attributes) {|Brut::Instrumentation::OpenTelemetry::Span| ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a span around the given block of code.</p>

<p>example, you could call this the method name, but should not include parameters in the name.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the name of the span. Should be specific to the code being wrapped, but not contain dynamic information. For</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash&lt;String|Symbol,Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Hash of attributes to include in this span. This is as if you called <span class='object_link'><a href="OpenTelemetry/Span.html#add_attributes-instance_method" title="Brut::Instrumentation::OpenTelemetry::Span#add_attributes (method)">Brut::Instrumentation::OpenTelemetry::Span#add_attributes</a></span> as the first line of the block.  There is a special attribute named <code>prefix:</code> that will control how attributes are prefixed.  If it is missing, the app's configured OTel prefix is used. If it is sent to <code>false</code>, no prefixing is done. Otherwise, the provided value is used as the prefix.  Generally, you don't want to set this so your app's prefix is used. Also note that the keys and values are automatically converted to primitive types, so you can use whatever makes sense. Just know that for rich objects <code>to_s</code> will be called.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="OpenTelemetry/Span.html" title="Brut::Instrumentation::OpenTelemetry::Span (class)">Brut::Instrumentation::OpenTelemetry::Span</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>executes this block in the context of a new OpenTelemetry span. yields
the span so you can call further methods on it.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>span</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="OpenTelemetry/Span.html" title="Brut::Instrumentation::OpenTelemetry::Span (class)">Brut::Instrumentation::OpenTelemetry::Span</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Whatever is returned from the block is returned by this method</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Whatever is returned from the block, unless an exception is raised.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if the block raises an exception, that exception will be raised, however <code>record_exception</code> will be called.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/instrumentation/open_telemetry.rb', line 19</span>

<span class='kw'>def</span> <span class='id identifier rubyid_span'>span</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span><span class='op'>**</span><span class='id identifier rubyid_attributes'>attributes</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_normalized_attributes'>normalized_attributes</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes (class)">NormalizedAttributes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#initialize-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='symbol'>:detect</span><span class='comma'>,</span><span class='id identifier rubyid_attributes'>attributes</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_h'><span class='object_link'><a href="OpenTelemetry/NormalizedAttributes.html#to_h-instance_method" title="Brut::Instrumentation::OpenTelemetry::NormalizedAttributes#to_h (method)">to_h</a></span></span>
  <span class='const'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span><span class='period'>.</span><span class='id identifier rubyid_container'><span class='object_link'><a href="../../Brut.html#container-class_method" title="Brut.container (method)">container</a></span></span><span class='period'>.</span><span class='id identifier rubyid_tracer'>tracer</span><span class='period'>.</span><span class='id identifier rubyid_in_span'>in_span</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='label'>attributes:</span> <span class='id identifier rubyid_normalized_attributes'>normalized_attributes</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_span'>span</span><span class='op'>|</span>
    <span class='id identifier rubyid_wrapped_span'>wrapped_span</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="OpenTelemetry/Span.html" title="Brut::Instrumentation::OpenTelemetry::Span (class)">Span</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_span'>span</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='lparen'>(</span><span class='id identifier rubyid_wrapped_span'>wrapped_span</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
      <span class='id identifier rubyid_span'>span</span><span class='period'>.</span><span class='id identifier rubyid_record_exception'>record_exception</span><span class='lparen'>(</span><span class='id identifier rubyid_ex'>ex</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Jun 25 22:57:21 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.4).
</div>

    </div>
  </body>
</html>