<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Brut::I18n::BaseMethods
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Brut::I18n::BaseMethods";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../I18n.html" title="Brut::I18n (module)">I18n</a></span></span>
     &raquo; 
    <span class="title">BaseMethods</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Brut::I18n::BaseMethods
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="ForBackEnd.html" title="Brut::I18n::ForBackEnd (module)">ForBackEnd</a></span>, <span class='object_link'><a href="ForCLI.html" title="Brut::I18n::ForCLI (module)">ForCLI</a></span>, <span class='object_link'><a href="ForHTML.html" title="Brut::I18n::ForHTML (module)">ForHTML</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/brut/i18n/base_methods.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Interface for translations, preferred over Ruby's I18n classes. Note that this is a
base module and not intended to be directly used in your classes.  Include one of
the other modules in this namespace:</p>

<ul>
<li><span class='object_link'><a href="ForHTML.html" title="Brut::I18n::ForHTML (module)">ForHTML</a></span> for components or pages, or anything use Phlex</li>
<li><span class='object_link'><a href="ForCLI.html" title="Brut::I18n::ForCLI (module)">ForCLI</a></span> for CLI apps</li>
<li><span class='object_link'><a href="ForBackEnd.html" title="Brut::I18n::ForBackEnd (module)">ForBackEnd</a></span> for back-end classes that aren't generating HTML</li>
</ul>


<p>This module assumes the existence of a three-method protocol that's used for HTML escaping in an
HTML-generating web context:</p>

<ul>
<li><code>capture</code> accepts the block yieled to <span class='object_link'><a href="#t-instance_method" title="Brut::I18n::BaseMethods#t (method)">#t</a></span> and returns whatever it generates.  This needs to exist
because Phlex's API renders to an internal buffer by default.  This module needs to allow Phlex
API methods to render to a different buffer.</li>
<li><code>safe</code> accepts a string and returns a string that is presumed to be HTML safe.</li>
<li><code>html_escape</code> accepts a string and returns a string that is HTML escaped.</li>
</ul>


<p>This module does not implement these methods and assumes that either the class using this module will
implement them or that a submodule being used does.  All submodules provided by Brut provide implementations,
so this information is only relevant if you are using this module directly.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#l-instance_method" title="#l (instance method)">#<strong>l</strong>(date_like, format: :default)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#t-instance_method" title="#t (instance method)">#<strong>t</strong>(key, **interpolated_values) { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Access a translation and insert interpolated elemens as needed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#t_direct-instance_method" title="#t_direct (instance method)">#<strong>t_direct</strong>(keys, interpolated_values = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Directly access translations without trying to be smart about deriving the key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#this_field_value-instance_method" title="#this_field_value (instance method)">#<strong>this_field_value</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="l-instance_method">
  
    #<strong>l</strong>(date_like, format: :default)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/i18n/base_methods.rb', line 223</span>

<span class='kw'>def</span> <span class='id identifier rubyid_l'>l</span><span class='lparen'>(</span><span class='id identifier rubyid_date_like'>date_like</span><span class='comma'>,</span> <span class='label'>format:</span> <span class='symbol'>:default</span><span class='rparen'>)</span>
  <span class='op'>::</span><span class='const'>I18n</span><span class='op'>::</span><span class='id identifier rubyid_l'>l</span><span class='lparen'>(</span><span class='id identifier rubyid_date_like'>date_like</span><span class='comma'>,</span><span class='label'>format:</span> <span class='id identifier rubyid_format'>format</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="t-instance_method">
  
    #<strong>t</strong>(key, **interpolated_values) { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Access a translation and insert interpolated elemens as needed. This will use the provided key to determine
the actual full key to the translation, as described below. See <span class='object_link'><a href="ForHTML.html#t-instance_method" title="Brut::I18n::ForHTML#t (method)">ForHTML#t</a></span> for details
on how this works in the context of a <span class='object_link'><a href="../FrontEnd/Component.html" title="Brut::FrontEnd::Component (class)">FrontEnd::Component</a></span> or <span class='object_link'><a href="../FrontEnd/Page.html" title="Brut::FrontEnd::Page (class)">FrontEnd::Page</a></span>.</p>

<p>Any missing interpolation will result in an exception, <em>except</em> for the value <code>field</code>. When
a string has <code>%{field}</code> in it, but <code>field:</code> is omitted in this call, the value for
<code>"cv.this_field"</code> is used. This value, in English, is "this field", so a call
to <code>t("email.required")</code> would generate <code>"This field is required"</code>, while a call
to <code>t("email.required", field: "E-mail address")</code> would generate <code>"E-mail address is required"</code>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'><p>Simplest usage</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  hello: &quot;Hi!&quot;
}
# in your code
t(:hello) # =&gt; Hi!</code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>Using an array for the key</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  actions: {
    edit: &quot;Make an edit&quot;
  }
}
# in your code
t([:actions, :edit]) # =&gt; Make an edit</code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>Using page:</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  new_widget: &quot;Make a New Widget&quot;,
  pages: {
    HomePage: {
      new_widget: &quot;Create new Widget&quot;
    },
    WidgetsPage: {
      new_widget: &quot;Create New&quot;
    },
  },
}
# in your code for HomePage
t(:new_widget) # =&gt; Create new Widget
# in your code for WidgetsPage
t(:new_widget) # =&gt; Create New
# in your code for SomeOtherPage
t(:new_widget) # =&gt; Make a New Widget</code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>Using in a component</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  status: {
    ready: &quot;Available&quot;,
    stalled: &quot;Stalled&quot;,
    completed: &quot;Done&quot;,
  },
  components: {
    TagComponent: {
      status: {
        ready: &quot;Ready&quot;,
        stalled: &quot;Waiting&quot;,
      }
    },
  },
}
# in your code for TagComponent
t(page: [ :status, :ready ]) # =&gt; Ready
t(page: [ :status, :completed ]) # =&gt; Done
# in your code for StatusComponent
t(page: [ :status, :ready ]) # =&gt; Available
t(page: [ :status, :completed ]) # =&gt; Done</code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>Using in a page-private component</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  status: {
    ready: &quot;Available&quot;,
    stalled: &quot;Stalled&quot;,
    completed: &quot;Done&quot;,
  },
  pages: {
    WidgetsPage: {
      new_widget: &quot;Create New&quot;,
      nevermind: &quot;Don&#39;t Create One&quot;,
    },
  }
  components: {
    &quot;WidgetsPage::WidgetComponent&quot;: {
      new_widget: &quot;Make New Widget&quot;,
    },
  },
}
# in your code for WidgetsPage::WidgetComponent
t(page: :new_widget) # =&gt; Make New Widget
t(page: :nevermind) # =&gt; Don&#39;t Create One</code></pre>
    
      
        <h5 class="example_title"><div class='inline'><p>Using a block in a page or component</p>
</div></h5>
      
      <pre class="example code"><code># in your translations file
en: {
  greeting: &quot;Hello there %{name}, you may %{block}&quot;,
}
# Inside a component where
# Brut::I18n::ForHTML has been included
def view_template
  h1 do
    raw(t(:greeting), name: user.name) do
      a(href: &quot;https://support.example.com&quot;) do
        &quot;contact support&quot;
      end
    end
  end
end
# This will produce this HTML, assuming user.name is &quot;Pat&quot;:
&lt;h1&gt;
  Hell there Pat, you may
  &lt;a href=&quot;https://support.example.com&quot;&gt;
    contact support
  &lt;/a&gt;
&lt;/h1&gt;</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String&gt;</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>used to create one or more keys to be translated.
This value's behavior balances predictabilitiy with what key is used and some flexibilty
to allow page– or component–specific translations when needed, and fallbacks when not.</p>

<p>When an array if given, the values are turned into strings and joined with a "." to
form a full key.</p>

<p>Depending on what class this module is mixed into, additional keys will be tried:</p>

<ul>
<li>If this is a page, <code>pages.«page_name».</code> will be prepended and tried before the key passed in.
If the <code>pages.«page_name»</code> version is not found, the exact key passed in is checked.</li>
<li>If this is a page private component, <code>pages.«page_name».</code> will be prepended and tried before
the key passed in. The value for <code>«page_name»</code> is determined by the outer class that this
component is a part of.</li>
<li>If this is a component (include if it is a page private component),
<code>components.«component_name».</code> will be prepended and tried before the key passed in.
If the <code>components.«component_name»</code> version is not found, the exact key passed in is checked.</li>
</ul>


<p>The priority of the keys are as follows:</p>

<ol>
<li>Component key is checked (unless this is a page)</li>
<li>Page key is checked (unless this is a non-page private component)</li>
<li>The literal key passed-in is checked</li>
</ol>


<p>If no value is found for any key an exception is raised.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>interpolated_values</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>values to use for interpolation of the key's translation. Note that if
<code>:block</code> is part of this has, you may not pass a block to this method.  Note also
that <code>:count</code> can be used if the key is expected to be pluralized.  This value
is required for keys that are designed for pluralization. See examples below.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**interpolated_values</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">count</span>
          <span class="type">(<tt>Numeric</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Special interpolation to control pluralization.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">block</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Value to use for <code>%{block}</code>. If this is used, a block may not be
yielded.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>If a block is passed, it is used for the value of <code>%{block}</code>. No parameters are yielded to the block.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The value to use for the <code>%{block}</code> interpolation value.  There is some nuance to
how this works.  The value returned is given to <code>capture</code>, and <em>that</em> value
is given to <code>safe</code>.  Outside of an HTML-rendering context, these methods
simply pass through the contents of the block.  In an HTML-rendering
context, however, these methods are assumed to be from
<a href="https://phlex.fun"><code>Phlex::HTML</code></a>.  <code>capture</code> will create a new Phlex
context and capture any HTML built inside the block.  That HTML is assumed
to be safe, thus <code>safe</code> is called to communicate this to Phlex.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>I18n::MissingTranslation</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if no translation is found</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>I18n::MissingInterpolationArgument</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if interpolation arguments are missing, or if the key
has pluralizations and no count: was given</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/i18n/base_methods.rb', line 189</span>

<span class='kw'>def</span> <span class='id identifier rubyid_t'>t</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='op'>**</span><span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='comma'>,</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_keys_to_check'>keys_to_check</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_is_page_private_component'>is_page_private_component</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd.html" title="Brut::FrontEnd (module)">FrontEnd</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd/Component.html" title="Brut::FrontEnd::Component (class)">Component</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                              <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_page_private?'>page_private?</span>
  <span class='id identifier rubyid_is_page'>is_page</span>                   <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd.html" title="Brut::FrontEnd (module)">FrontEnd</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd/Page.html" title="Brut::FrontEnd::Page (class)">Page</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_is_component'>is_component</span>              <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd.html" title="Brut::FrontEnd (module)">FrontEnd</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../FrontEnd/Component.html" title="Brut::FrontEnd::Component (class)">Component</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_is_page'>is_page</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_is_component'>is_component</span>
    <span class='id identifier rubyid_keys_to_check'>keys_to_check</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>components.</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_component_name'>component_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_is_page'>is_page</span>
    <span class='id identifier rubyid_keys_to_check'>keys_to_check</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pages.</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_page_name'>page_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_is_page_private_component'>is_page_private_component</span>
    <span class='id identifier rubyid_keys_to_check'>keys_to_check</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pages.</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_containing_page_name'>containing_page_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_keys_to_check'>keys_to_check</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_key'>key</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='lbracket'>[</span><span class='symbol'>:block</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>t was given a block and a block: param. You can&#39;t do both </span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_block_contents'>block_contents</span> <span class='op'>=</span> <span class='id identifier rubyid_safe'>safe</span><span class='lparen'>(</span><span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='lbracket'>[</span><span class='symbol'>:block</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_block_contents'>block_contents</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_t_direct'>t_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_keys_to_check'>keys_to_check</span><span class='comma'>,</span><span class='op'>**</span><span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='comma'>,</span> <span class='label'>key_given:</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../I18n.html" title="Brut::I18n (module)">I18n</a></span></span><span class='op'>::</span><span class='const'>MissingInterpolationArgument</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_ex'>ex</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_ex'>ex</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>block</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>One of the keys </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> contained a %{block} interpolation value: &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ex'>ex</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;. This means you must yield a block to `t`</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="t_direct-instance_method">
  
    #<strong>t_direct</strong>(keys, interpolated_values = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Directly access translations without trying to be smart about deriving the key.  This is useful
if you have the exact keys you want.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>keys</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>, <tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>list of keys representing what is to be translated. The
first key found will be used. If no key in the list is found
will raise a I18n::MissingTranslation.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>interpolated_values</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>value to use for interpolation of the key's translation</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>interpolated_values</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">count</span>
          <span class="type">(<tt>Numeric</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>Special interpolation to control pluralization.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">key_given</span>
          <span class="type">(<tt>String|Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>If included, this is not used for interpolation, but
will be used in error messages to represent the key
given to <code>t</code>.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>I18n::MissingTranslation</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if no translation is found</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt>I18n::MissingInterpolationArgument</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if interpolation arguments are missing, or if the key
has pluralizations and no count: was given</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/i18n/base_methods.rb', line 246</span>

<span class='kw'>def</span> <span class='id identifier rubyid_t_direct'>t_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span><span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_keys'>keys</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_key_given'>key_given</span> <span class='op'>=</span> <span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:key_given</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_default_interpolated_values'>default_interpolated_values</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>field:</span> <span class='id identifier rubyid_this_field_value'>this_field_value</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_escaped_interpolated_values'>escaped_interpolated_values</span> <span class='op'>=</span> <span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='lbracket'>[</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_html_escape'>html_escape</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='lbracket'>[</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_t'>t</span><span class='lparen'>(</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='label'>default:</span> <span class='id identifier rubyid_keys'>keys</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='label'>raise:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_default_interpolated_values'>default_interpolated_values</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_escaped_interpolated_values'>escaped_interpolated_values</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_incorrect_pluralization'>incorrect_pluralization</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_none?'>none?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='symbol'>:one</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_incorrect_pluralization'>incorrect_pluralization</span>
      <span class='id identifier rubyid_key_message'>key_message</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_key_given'>key_given</span>
                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Key &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key_given'>key_given</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
                    <span class='kw'>else</span>
                      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>One of the keys</span><span class='tstring_end'>&quot;</span></span>
                    <span class='kw'>end</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../Brut.html" title="Brut (module)">Brut</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Framework.html" title="Brut::Framework (module)">Framework</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Framework/Errors.html" title="Brut::Framework::Errors (module)">Errors</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Framework/Errors/Bug.html" title="Brut::Framework::Errors::Bug (class)">Bug</a></span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key_message'>key_message</span><span class='embexpr_end'>}</span><span class='tstring_content'> resulted in a Hash that doesn&#39;t appear to be created for pluralizations. This means that you may have given a key expecting it to map to a translation but it is actually a namespace for other keys.  Please adjust your translations file to avoid this situation. Keys checked:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>\nSub keys found:\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../I18n.html" title="Brut::I18n (module)">I18n</a></span></span><span class='op'>::</span><span class='const'>MissingInterpolationArgument</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:count</span><span class='comma'>,</span><span class='id identifier rubyid_interpolated_values'>interpolated_values</span><span class='comma'>,</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="this_field_value-instance_method">
  
    #<strong>this_field_value</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


227
228
229</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/brut/i18n/base_methods.rb', line 227</span>

<span class='kw'>def</span> <span class='id identifier rubyid_this_field_value'>this_field_value</span>
  <span class='ivar'>@__this_field_value</span> <span class='op'>||=</span> <span class='op'>::</span><span class='const'>I18n</span><span class='period'>.</span><span class='id identifier rubyid_t'>t</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cv.this_field</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>raise:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Sep  5 13:46:22 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.5).
</div>

    </div>
  </body>
</html>